let queue=Promise.resolve();function send_queued_requests(e,t,a,n,o){return queue=queue.catch(()=>{}).then(()=>build_payload(e,t,a,n,o))}function build_payload(s,i,r,d,l){return new Promise((t,a)=>{var e=format_datetime(i.event_timestamp),n=format_datetime(i.page_data.page_timestamp),o=parse_user_agent();i.event_date=e.date,i.event_data.user_agent=o.ua,i.event_data.browser_name=o.browser.name,i.event_data.browser_language=o.browser.language,i.event_data.browser_version=o.browser.version,i.event_data.device_type=o.device.type||"desktop",i.event_data.device_vendor=o.device.vendor,i.event_data.device_model=o.device.model,i.event_data.os_name=o.os.name,i.event_data.os_version=o.os.version,i.event_data.screen_size=window.screen.width+"x"+window.screen.height,i.event_data.viewport_size=window.innerWidth+"x"+window.innerHeight,i.page_date=n.date,i.page_data.page_language=document.documentElement.lang,l&&"page_view"==i.event_data.event_type?fetch(window.location.href,{method:"HEAD"}).then(e=>{i.page_data.page_status_code=e.status,send_requests(s,i,r,d,t,a)}):send_requests(s,i,r,d,t,a)})}function send_requests(e,t,a,n,o,s){n&&console.log(t.event_name,">","SENDING REQUEST"),fetch(e,{method:"POST",credentials:"include",mode:"cors",keepalive:!0,body:JSON.stringify(t)}).then(e=>e.json()).then(e=>{200===e.status_code?(n&&console.log(t.event_name,">","  ðŸ‘‰ Payload data: ",e.data),n&&console.log(t.event_name,">","REQUEST STATUS"),n&&console.log(t.event_name,">"," ",e.response)):(n&&console.log(t.event_name,">  ",e.response),n&&console.log(t.event_name,">","REQUEST STATUS"),n&&console.log(t.event_name,">","  ðŸ”´ Request refused")),a.gtmOnSuccess(),o(e.data)}).catch(e=>{n&&console.log(t.event_name,">","  ðŸ”´",e),n&&console.log(t.event_name,">","REQUEST STATUS"),n&&console.log(t.event_name,">","  ðŸ”´ Request not sent successfully"),a.gtmOnSuccess(),s(e)})}function format_datetime(e){var e=new Date(e),t=e.getUTCFullYear(),a=String(e.getUTCMonth()+1).padStart(2,"0"),n=String(e.getUTCDate()).padStart(2,"0"),o=String(e.getUTCHours()).padStart(2,"0"),s=String(e.getUTCMinutes()).padStart(2,"0"),i=String(e.getUTCSeconds()).padStart(2,"0"),e=String(e.getUTCMilliseconds()).padStart(3,"0");return{date:t+`-${a}-`+n,date_time:t+`-${a}-${n}T${o}:${s}:`+i,date_time_millis:t+`-${a}-${n}T${o}:${s}:`+i+"."+e,date_time_micros:t+`-${a}-${n}T${o}:${s}:`+i+`.${e}000`,year:t,month:a,day:n,hours:o,minutes:s,seconds:i,milliseconds:"."+e,microseconds:`.${e}000`}}let parse_user_agent=function(){var e=(new UAParser).getResult();return e.browser.language=navigator.language,e};function get_channel_grouping(e,t){var a={search_engine:new RegExp("360\\.cn|alice|aol|ar\\.search\\.yahoo\\.com|ask|bing|google|yahoo|yandex|baidu|ecosia|duckduckgo|sogou|naver|seznam","i"),social:new RegExp("facebook|twitter|instagram|pinterest|linkedin|reddit|vk\\.com|tiktok|snapchat|tumblr|wechat|whatsapp","i"),shopping:new RegExp("amazon|ebay|etsy|shopify|stripe|walmart|mercadolibre|alibaba|naver\\.shopping","i"),video:new RegExp("youtube|vimeo|netflix|twitch|dailymotion|hulu|disneyplus|wistia|youku","i"),ai:new RegExp("chatgpt|gemini|bard|claude|alexa|siri|assistant|\\.ai([/]|$)","i"),email:new RegExp("email|e-mail|newsletter|mailchimp|sendgrid|sparkpost","i")};return e?"direct"===e?"direct":"tagassistant.google.com"===e?"gtm_debugger":a.search_engine.test(e)?t?"paid_search_engine":"organic_search_engine":a.social.test(e)?t?"paid_social":"organic_social":a.shopping.test(e)?t?"paid_shopping":"organic_shopping":a.video.test(e)?t?"paid_video":"organic_video":a.ai.test(e)?"ai":a.email.test(e)?"email":t?"affiliate":"referral":"internal_traffic"}function set_cross_domain_listener(e,t,l,c){let g=e,_=t;document.addEventListener("click",function(e){if(e.target instanceof Element){var s=e.target.closest("a");if(s&&s.getAttribute("href")){let o=(s.getAttribute("href")||"").trim();if(o){var i=/^(#|javascript:|tel:|mailto:)/i.test(o);if(!i){let a;try{a=new URL(o,window.location.href)}catch(e){return}let t=a.hostname;var i=_.some(e=>t===e||t.endsWith("."+e)),r=_.some(e=>(window.location.hostname===e||window.location.hostname.endsWith("."+e))&&(t===e||t.endsWith("."+e))),s=s.getAttribute("target"),d=get_last_consent_values(),d=1==d.analytics_storage||null==d.analytics_storage;let n=null;!i||r||i&&!(!l||d)||(e.preventDefault(),i&&"_blank"===s&&(n=window.open("about:blank","_blank")),get_user_data(g,{event_name:"get_user_data",event_origin:"Website"},c).then(e=>{c&&console.log("cross-domain > NAMELESS ANALYTICS"),c&&console.log("cross-domain > ASK USER DATA");var t=e.data,t=(c&&console.log("cross-domain >   ðŸ‘‰ User data: ",t),c&&console.log("cross-domain > CHECK USER DATA"),t.client_id,t.session_id);t&&"undefined"!=t?(c&&console.log("cross-domain >   ðŸŸ¢ Valid user data. Cross-domain URL link decoration will be applied"),a.searchParams.set("na_id",t)):c&&console.log("cross-domain > ",e.response),c&&console.log("cross-domain >   ðŸ‘‰ Redirect to: "+a.href),n?n.location.href=a.href:window.location.href=a.href}).catch(e=>{c&&console.log("cross-domain > NAMELESS ANALYTICS"),c&&console.log("cross-domain > ASK USER DATA"),console.log("cross-domain >   ðŸ”´ Error while fetch user data: "+e),c&&console.log("cross-domain >   ðŸ‘‰ Redirect to: "+o),n?n.location.href=o:window.location.href=o}))}}}}})}function get_last_consent_values(){var e,t,a;if("undefined"!=typeof google_tag_data&&google_tag_data)return e=google_tag_data.ics.usedDefault,t=google_tag_data.ics.usedUpdate,a=google_tag_data.ics.entries,{consent_type:e?t?"Update":"Default":"Consent mode not present",ad_user_data:e?a.ad_user_data.update||a.ad_user_data.default:null,ad_personalization:e?a.ad_personalization.update||a.ad_personalization.default:null,ad_storage:e?a.ad_storage.update||a.ad_storage.default:null,analytics_storage:e?a.analytics_storage.update||a.analytics_storage.default:null,functionality_storage:e?a.functionality_storage.update||a.functionality_storage.default:null,personalization_storage:e?a.personalization_storage.update||a.personalization_storage.default:null,security_storage:e?a.security_storage.update||a.security_storage.default:null}}function get_user_data(e,t,a){if("undefined"!==e.split("/")[2].split(".")[1])return fetch(e,{method:"POST",credentials:"include",mode:"cors",keepalive:!0,body:JSON.stringify(t)}).then(e=>e.json()).then(e=>e)}